#include <kipr/wombat.h>
int closed = 655;
int open = 1900;
int servoPort = 0;
int threshold = 2000;
int maxspeed = 200;
void swipeClose() {
    set_servo_position(servoPort, closed);
}

void swipeOpen() {
	set_servo_position(servoPort, open);   
}

void fwdDistance(int d) {
    set_create_distance(0);
    while(get_create_distance()	< d) {
        create_drive_straight(500);
        msleep(10);
    }
    create_stop();
}

void driveToLine() {
    int rspeed = maxspeed;
    int lspeed = maxspeed;
    while(get_create_lfcliff_amt() > threshold || get_create_lfcliff_amt() > threshold) {
        lspeed = (get_create_lcliff_amt() > threshold) ? maxspeed : 0;
        printf("lcliff: %d\n", get_create_lcliff_amt());
        rspeed = (get_create_rcliff_amt() > threshold) ? maxspeed : 0;
        printf("rcliff: %d\n", get_create_rcliff_amt());
        create_drive_direct(lspeed, rspeed);
        msleep(50);
    }
    create_stop();
}

void turnLeft() {
	create_drive_direct(-200, 200);
    msleep(1000);
    create_stop();
}

void turnRight() {
	set_create_distance(0);
    while(get_create_distance()	< 180) {
        create_drive_direct(500, 0);
        msleep(10);
    }
    create_stop();
}
int main()
{
    create_connect();
    swipeClose();
    driveToLine();
    driveToLine();
    swipeOpen();
    turnLeft();
    create_disconnect();
    return 0;
}
